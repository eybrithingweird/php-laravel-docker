var $=s=>{throw TypeError(s)};var H=(s,t,i)=>t.has(s)||$("Cannot "+i);var c=(s,t,i)=>(H(s,t,"read from private field"),i?i.call(s):t.get(s)),A=(s,t,i)=>t.has(s)?$("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,i),M=(s,t,i,n)=>(H(s,t,"write to private field"),n?n.call(s,i):t.set(s,i),i),K=(s,t,i)=>(H(s,t,"access private method"),i);import{S as se,s as ie,h as G,g as ne,n as W,a as X,r as o,b as le,c as re,d as v,j as e,e as Y,L as Z,A as ae}from"./app-DLpcm0V-.js";import{C as B,H as ee}from"./ComboboxMain-C4nOrFEA.js";var E,w,g,C,q,P,z,V,de=(V=class extends se{constructor(t,i){super();A(this,q);A(this,E);A(this,w);A(this,g);A(this,C);M(this,E,t),this.setOptions(i),this.bindMethods(),K(this,q,P).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var n;const i=this.options;this.options=c(this,E).defaultMutationOptions(t),ie(this.options,i)||c(this,E).getMutationCache().notify({type:"observerOptionsUpdated",mutation:c(this,g),observer:this}),i!=null&&i.mutationKey&&this.options.mutationKey&&G(i.mutationKey)!==G(this.options.mutationKey)?this.reset():((n=c(this,g))==null?void 0:n.state.status)==="pending"&&c(this,g).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=c(this,g))==null||t.removeObserver(this)}onMutationUpdate(t){K(this,q,P).call(this),K(this,q,z).call(this,t)}getCurrentResult(){return c(this,w)}reset(){var t;(t=c(this,g))==null||t.removeObserver(this),M(this,g,void 0),K(this,q,P).call(this),K(this,q,z).call(this)}mutate(t,i){var n;return M(this,C,i),(n=c(this,g))==null||n.removeObserver(this),M(this,g,c(this,E).getMutationCache().build(c(this,E),this.options)),c(this,g).addObserver(this),c(this,g).execute(t)}},E=new WeakMap,w=new WeakMap,g=new WeakMap,C=new WeakMap,q=new WeakSet,P=function(){var i;const t=((i=c(this,g))==null?void 0:i.state)??ne();M(this,w,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},z=function(t){W.batch(()=>{var i,n,l,h,a,p,m,u;if(c(this,C)&&this.hasListeners()){const d=c(this,w).variables,f=c(this,w).context;(t==null?void 0:t.type)==="success"?((n=(i=c(this,C)).onSuccess)==null||n.call(i,t.data,d,f),(h=(l=c(this,C)).onSettled)==null||h.call(l,t.data,null,d,f)):(t==null?void 0:t.type)==="error"&&((p=(a=c(this,C)).onError)==null||p.call(a,t.error,d,f),(u=(m=c(this,C)).onSettled)==null||u.call(m,void 0,t.error,d,f))}this.listeners.forEach(d=>{d(c(this,w))})})},V);function J(s,t){const i=X(),[n]=o.useState(()=>new de(i,s));o.useEffect(()=>{n.setOptions(s)},[n,s]);const l=o.useSyncExternalStore(o.useCallback(a=>n.subscribe(W.batchCalls(a)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),h=o.useCallback((a,p)=>{n.mutate(a,p).catch(le)},[n]);if(l.error&&re(n.options.throwOnError,[l.error]))throw l.error;return{...l,mutate:h,mutateAsync:l.mutate}}const ce=()=>{const{selectedTab:s,setSelectedTab:t}=v();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-2xl text-center text-gray-800 border-b",children:e.jsxs("ul",{className:"flex flex-wrap -mb-px",children:[e.jsx("li",{className:"me-2",children:e.jsx("a",{href:"#",className:s==="add"?"inline-block p-4 text-black border-b-2 border-iit-box bg-iit-box rounded-t-lg active":"inline-block p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-800 bg-iit-gray text-stone-300 hover:text-iit-yellow","aria-current":s==="add"?"page":"false",onClick:()=>t("add"),children:"Add New Letter Request"})}),e.jsx("li",{className:"me-2",children:e.jsx("a",{href:"#",className:s==="fields"?"inline-block p-4 text-black border-b-2 border-iit-box bg-iit-box rounded-t-lg active":"inline-block p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-800 bg-iit-gray text-stone-300 hover:text-iit-yellow","aria-current":s==="fields"?"page":"false",onClick:()=>t("fields"),children:"Add Fields to Request Type"})}),e.jsx("li",{className:"me-2",children:e.jsx("a",{href:"#",className:s==="existing"?"inline-block p-4 text-black border-b-2 border-iit-box bg-iit-box rounded-t-lg active":"inline-block p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-800 bg-iit-gray text-stone-300 hover:text-iit-yellow","aria-current":s==="existing"?"page":"false",onClick:()=>t("existing"),children:"Add Default Channels to Request Type"})}),e.jsx("li",{className:"me-2",children:e.jsx("a",{href:"#",className:s==="delete"?"inline-block p-4 text-black border-b-2 border-iit-box bg-iit-box rounded-t-lg active":"inline-block p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-800 bg-iit-gray text-stone-300 hover:text-iit-yellow","aria-current":s==="delete"?"page":"false",onClick:()=>t("delete"),children:"Delete Letter Request Type"})}),e.jsx("li",{className:"me-2",children:e.jsx("a",{href:"#",className:s==="edit"?"inline-block p-4 text-black border-b-2 border-iit-box bg-iit-box rounded-t-lg active":"inline-block p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-800 bg-iit-gray text-stone-300 hover:text-iit-yellow","aria-current":s==="edit"?"page":"false",onClick:()=>t("edit"),children:"Edit Employee Status"})})]})})})},oe=()=>{const[s,t]=o.useState("Start typing or select request type..."),[i,n]=o.useState(""),{requestTypes:l,isFetchingReq:h,selectedRequestType:a,setSelectedRequestType:p,employees:m,isFetchingEmp:u,selectedEmployee:d,setSelectedEmployee:f,offices:y,isFetchingOff:b,selectedOffice:j,setSelectedOffice:O,channels:S,isFetchingChan:x,selectedChannels:T,setSelectedChannels:_,designations:k,isFetchingDes:R,filteredDesignations:N,selectedDesignation:F,setSelectedDesignation:r,selectedOpt:L,setSelectedOpt:U,addChannel:D}=v(),I=i===""?l:l.filter(Q=>Q.reqtype.toLowerCase().includes(i.toLowerCase())||Q.reqtype.toLowerCase().includes("other"));return e.jsx(e.Fragment,{children:h?e.jsx("div",{className:"relative",children:e.jsx("div",{className:"form-control disabled text-gray-400",children:"Loading..."})}):e.jsx(B,{type:"requesttype",filteredOptions:I,selectedOption:s,setSelectedOption:t,query:i,setQuery:n,setSelectedRequestType:p,setSelectedOffice:null,setSelectedDesignation:null,setSelectedEmployee:null})})};function ue(s){return e.jsx("span",{className:`absolute z-10 
				${s.content.toLowerCase().includes("default")?"":"top-12"}
				right-12 group-hover:opacity-100 opacity-0 transition-opacity bg-orange-400 p-2 text-2xl text-black rounded-md m-4 mx-auto`,children:s.content})}const he=()=>{const{requestTypes:s,isFetchingReq:t,selectedRequestType:i,setSelectedRequestType:n,employees:l,isFetchingEmp:h,selectedEmployee:a,setSelectedEmployee:p,offices:m,isFetchingOff:u,selectedOffice:d,setSelectedOffice:f,channels:y,isFetchingChan:b,selectedChannels:j,setSelectedChannels:O,designations:S,isFetchingDes:x,selectedDesignation:T,setSelectedDesignation:_,selectedOpt:k,setSelectedOpt:R}=v(),[N,F]=o.useState(h?"Loading...":l[2].first_name.toUpperCase()+" "+l[2].last_name.toUpperCase()),[r,L]=o.useState(""),U=r===""?l:l.filter(D=>D.last_name.toLowerCase().includes(r.toLowerCase())||D.first_name.toLowerCase().includes(r.toLowerCase()));return h||p(l[2].first_name.toUpperCase()+" "+l[2].last_name.toUpperCase()),e.jsx(e.Fragment,{children:h?e.jsx("div",{className:"relative",children:e.jsx("div",{className:"form-control disabled text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"group",children:[e.jsx(ee,{disabled:!0,children:e.jsx(B,{type:"employee",filteredOptions:U,selectedOption:N,setSelectedOption:F,setSelectedOpt:null,query:r,setQuery:L,setSelectedOffice:null,setSelectedDesignation:null,setSelectedEmployee:p})}),e.jsx("span",{className:"text-orange-800",children:"(Default final person to receive the letter request has been pre-selected.)"})]})})},pe=()=>{const[s,t]=o.useState("Start typing or select an office..."),[i,n]=o.useState(""),{requestTypes:l,isFetchingReq:h,selectedRequestType:a,setSelectedRequestType:p,employees:m,isFetchingEmp:u,selectedEmployee:d,setSelectedEmployee:f,offices:y,isFetchingOff:b,selectedOffice:j,setSelectedOffice:O,channels:S,isFetchingChan:x,selectedChannels:T,setSelectedChannels:_,designations:k,isFetchingDes:R,selectedDesignation:N,setSelectedDesignation:F,selectedOpt:r,setSelectedOpt:L}=v(),U=i===""?y:y.filter(D=>D.address.toLowerCase().includes(i.toLowerCase()));return e.jsx(e.Fragment,{children:e.jsx("div",{className:"row-span-1 col-span-7",children:b?e.jsx("div",{className:"relative",children:e.jsx("div",{className:"form-control disabled text-gray-400",children:"Loading..."})}):e.jsx(B,{type:"office",filteredOptions:U,selectedOption:s,setSelectedOption:t,setSelectedOpt:null,query:i,setQuery:n,setSelectedOffice:O,setSelectedDesignation:null,setSelectedEmployee:null})})})},xe=()=>{const{requestTypes:s,isFetchingReq:t,selectedRequestType:i,setSelectedRequestType:n,employees:l,isFetchingEmp:h,selectedEmployee:a,setSelectedEmployee:p,offices:m,isFetchingOff:u,selectedOffice:d,setSelectedOffice:f,channels:y,isFetchingChan:b,selectedChannels:j,setSelectedChannels:O,designations:S,isFetchingDes:x,filteredDesignations:T,selectedDesignation:_,setSelectedDesignation:k,selectedOpt:R,setSelectedOpt:N,addChannel:F}=v();return e.jsxs("table",{className:"grid grid-cols-12 p-1",children:[e.jsx("thead",{className:"grid grid-cols-subgrid col-span-12 gap-2",children:e.jsxs("tr",{className:"grid grid-cols-subgrid col-span-12",children:[e.jsx("th",{className:"grid grid-cols-subgrid col-span-1 text-center",children:"Step #"}),e.jsx("th",{className:"grid grid-cols-subgrid col-span-5",children:"Office"}),e.jsx("th",{className:"grid grid-cols-subgrid col-span-5",children:"Designation"})]})}),e.jsx("tbody",{className:"grid grid-cols-subgrid col-span-12 gap-2",children:j.map(r=>e.jsxs("tr",{className:"grid grid-cols-subgrid col-span-12",children:[e.jsx("td",{className:"grid grid-cols-subgrid col-span-1 text-center",children:r.id},r.id+" "+r.office_id),e.jsx("td",{className:"grid grid-cols-subgrid col-span-5",children:r.office},r.office_id+" office"),e.jsx("td",{className:"grid grid-cols-subgrid col-span-5",children:r.designation},r.designation_id+" designation")]},r.id+" "+r.office_id))})]})},ge=()=>{const[s,t]=o.useState("Start typing or select a designation..."),[i,n]=o.useState(""),{requestTypes:l,isFetchingReq:h,selectedRequestType:a,setSelectedRequestType:p,employees:m,isFetchingEmp:u,selectedEmployee:d,setSelectedEmployee:f,offices:y,isFetchingOff:b,selectedOffice:j,setSelectedOffice:O,channels:S,isFetchingChan:x,selectedChannels:T,setSelectedChannels:_,designations:k,isFetchingDes:R,filteredDesignations:N,selectedDesignation:F,setSelectedDesignation:r,selectedOpt:L,setSelectedOpt:U,addChannel:D}=v(),I=i===""?N:N.filter(Q=>Q.designation.toLowerCase().includes(i.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"row-span-1 col-span-4",children:R?e.jsx("div",{className:"relative",children:e.jsx("div",{className:"form-control disabled text-gray-400",children:"Loading..."})}):j==""?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"group",children:[e.jsx(ee,{disabled:!0,children:e.jsx(B,{type:"designation",filteredOptions:I,selectedOption:s,setSelectedOption:t,setSelectedOpt:null,query:i,setQuery:n,setSelectedOffice:null,setSelectedDesignation:r,setSelectedEmployee:null})}),e.jsx(ue,{content:"Select an office first before selecting a designation."})]})}):e.jsx(B,{type:"designation",filteredOptions:I,selectedOption:s,setSelectedOption:t,setSelectedOpt:null,query:i,setQuery:n,setSelectedOffice:null,setSelectedDesignation:r,setSelectedEmployee:null})}),e.jsx("span",{className:"input-group-btn",children:e.jsx("button",{className:"add_field_button btn btn-success btn-flat",type:"button",onClick:D,children:"Add"})}),e.jsx("div",{className:"col-span-12",id:"displayAddedChannels",children:e.jsx(e.Fragment,{children:T.length>0?e.jsx(xe,{}):null})})]})},me=async s=>await Y.post("/api/channels",s).then(t=>t.data.data).catch(t=>{throw console.log(t),t}),fe=async s=>(console.log(s),Y.post("/api/requesttypes",s).then(t=>t.data.data).catch(t=>{throw console.log(t),t})),te=()=>{const s=X(),[t,i]=o.useState(""),[n,l]=o.useState(null),[h,a]=o.useState(!1),[p,m]=o.useState([]),[u,d]=o.useState({}),{requestTypes:f,selectedRequestType:y,selectedChannels:b,employees:j,selectedEmployee:O,offices:S}=v();o.useEffect(()=>{h&&x()},[p]);const x=async()=>{const r=f.filter(L=>L.reqtype===y)[0].id;return await k({request_type_id:r,dst_offices_dsg_id:p})},T=()=>{a(!0),l(null),i(""),m(b.map(r=>[r.office_id,r.designation_id]))},_={onSuccess:async()=>{await s.invalidateQueries({queryKey:["channels"]}),a(!1),i("Channels have been added.")},onError:r=>{console.error(r),l(r.message),a(!1)}},{mutateAsync:k}=J({mutationKey:["postChannels"],mutationFn:me,..._}),R=async()=>(a(!0),l(null),i(""),await F({reqtype:u==null?void 0:u.reqtype,definition:u==null?void 0:u.definition})),N={onSuccess:async()=>{await s.invalidateQueries({queryKey:["requesttypes"]}),a(!1),i("Request type and its description has been added.")},onError:r=>{console.error(r),l(r.message),a(!1)}},{mutateAsync:F}=J({mutationKey:["addRequestType"],mutationFn:fe,...N});return{newChannelData:u,setNewChannelData:d,isSubmitting:h,setIsSubmitting:a,error:n,setError:l,success:t,setSuccess:i,filterSubmit:T,handleSubmit:x,addRequestTypeSubmit:R}},be=()=>{const s=document.getElementById("container").getAttribute("token"),{filterSubmit:t,isSubmitting:i,success:n,error:l,setError:h}=te(),{designations:a,offices:p,employees:m,selectedEmployee:u,selectedChannels:d,setSelectedChannels:f,selectedRequestType:y}=v(),[b,j]=o.useState(0);o.useEffect(()=>{d.length!=b&&b!=0&&t()},[d]);const O=()=>{if(j(d.length),b!=0&&y!=""){const S=m.filter(x=>x.first_name.toUpperCase()+" "+x.last_name.toUpperCase()===u.toString())[0];f([...d,{id:d.length+1,office_id:1,office:p.filter(x=>x.id===S.designation_id)[0].address,designation_id:S.designation_id,designation:a.filter(x=>x.id===S.designation_id)[0].designation}])}else h("All fields are required.")};return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"hidden",name:"_token",value:s}),e.jsxs("table",{className:"table table-bordered",id:"type",encType:"multipart/form-data",children:[e.jsx("thead",{children:e.jsx("tr",{className:"active",children:e.jsxs("th",{colSpan:"2",children:["Please fill-in appropriate information. Required fields are marked as ",e.jsx("span",{className:"text-danger text-3xl",children:"*"})]})})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsxs("td",{width:"30%",className:"warning",children:["Request Type ",e.jsx("span",{className:"text-danger text-3xl",children:"*"})]}),e.jsx("td",{children:e.jsx(oe,{})})]}),e.jsxs("tr",{children:[e.jsxs("td",{className:"warning",children:["To ",e.jsx("span",{className:"text-danger text-3xl",children:"*"})," ",e.jsx("br",{}),e.jsx("small",{children:"Last and final person to receive the letter request."})]}),e.jsx("td",{children:e.jsx(he,{})})]}),e.jsxs("tr",{children:[e.jsxs("td",{className:"warning",children:["Default Thru Channels ",e.jsx("span",{className:"text-danger text-3xl",children:"*"})," ",e.jsx("br",{}),e.jsx("small",{children:"Offices/persons to be sent for the letter request."})," ",e.jsx("br",{}),e.jsx("small",{children:"Add the offices/persons from first to second-to-the-last."})]}),e.jsx("td",{children:e.jsxs("div",{className:"input-group grid grid-cols-12 gap-2",children:[e.jsx(pe,{}),e.jsx(ge,{})]})})]}),e.jsxs("tr",{children:[e.jsx("td",{}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-default",onClick:O,children:"Save"}),n!=""?e.jsx("span",{className:"pl-2 text-iit-green",children:"Channels successfully saved."}):"",l!=null?e.jsxs("span",{className:"pl-2 text-iit-red",children:["Error occurred: ",l]}):"",i?e.jsxs("span",{className:"absolute pl-2 pt-1",children:[" ",e.jsx(Z,{height:"27px",width:"27px"})," "]}):""]})]})]})]})]})},ye=()=>{const s=document.getElementById("container").getAttribute("token"),{newChannelData:t,setNewChannelData:i,addRequestTypeSubmit:n,isSubmitting:l,success:h,error:a,setError:p}=te();o.useState(0),o.useEffect(()=>{t.definition!=null&&t.reqtype!=null&&n()},[t]);const m=()=>{const u=document.getElementById("request_type_name").value,d=document.getElementById("request_type_description").value;u!=""&&d!=""||u!=" "&&d==" "?i({reqtype:u,definition:d}):p("All fields are required.")};return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"hidden",name:"_token",value:s}),e.jsxs("table",{className:"table table-bordered",id:"type",encType:"multipart/form-data",children:[e.jsx("thead",{children:e.jsx("tr",{className:"active",children:e.jsxs("th",{colSpan:"2",children:["Please fill-in appropriate information. Required fields are marked as ",e.jsx("span",{className:"text-danger text-3xl",children:"*"})]})})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsxs("td",{width:"30%",className:"warning",children:["Request Type Name",e.jsx("span",{className:"text-danger text-3xl",children:"*"})]}),e.jsx("td",{children:e.jsx("input",{type:"text",name:"price",id:"request_type_name",className:"form-control block w-full",placeholder:"Request type name"})})]}),e.jsxs("tr",{children:[e.jsxs("td",{className:"warning",children:["Description ",e.jsx("span",{className:"text-danger text-3xl",children:"*"})," ",e.jsx("br",{})]}),e.jsx("td",{children:e.jsx("textarea",{className:"form-control",rows:"10",id:"request_type_description",placeholder:"Type the request type's description here..."})})]}),e.jsxs("tr",{children:[e.jsx("td",{}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-default",onClick:m,children:"Save"}),h!=""?e.jsx("span",{className:"pl-2 text-iit-green",children:"Request type successfully created."}):"",a!=null?e.jsxs("span",{className:"pl-2 text-iit-red",children:["Error occurred: ",a]}):"",l?e.jsxs("span",{className:"absolute pl-2 pt-1",children:[" ",e.jsx(Z,{height:"27px",width:"27px"})," "]}):""]})]})]})]})]})},je=()=>{const{selectedTab:s}=v();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"box-header with-border",children:e.jsx("h3",{className:"box-title right-0",children:(()=>{switch(s){case"add":return"Add New Letter Request Type";case"fields":return"Add Fields to Request Type";case"existing":return"Add Default Channels to Request Type";case"delete":return"Delete Letter Request Type";case"edit":return"Edit Employee Status";default:return"Select a tab to continue"}})()})}),e.jsx("div",{className:"box-body",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-9",children:(()=>{switch(s){case"add":return e.jsx(ye,{});case"fields":return"Add Fields to Request Type";case"existing":return e.jsx(be,{});case"delete":return"Delete Letter Request Type";case"edit":return"Edit Employee Status";default:return""}})()}),e.jsx("div",{className:"col-lg-3"})]})})]})};function qe(){return e.jsx(e.Fragment,{children:e.jsxs(ae,{children:[e.jsx("section",{className:"content-header pt-24",children:e.jsx("h1",{children:"Admin Dashboard"})}),e.jsxs("section",{className:"content",children:[e.jsx(ce,{}),e.jsx("div",{className:"box box-default",children:e.jsx(je,{})})]})]})})}export{qe as default};
